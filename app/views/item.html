<!-- LIST ITEM -->
<div class="flex" ng-if="track.type !== 'separator'" ng-class="{'open': open && (track.type === 'playlist' || track.type === 'playlist-repost') || desc}">

    <!-- PLAY OR PLAYLIST icon, user and repost icon -->
    <div class="meta">
        <div class="controls fl" ng-if="track.type != 'playlist' && track.type != 'playlist-repost'">
            <button class="play btn" ng-click="controlAudio.play(track.index)" ng-hide="helpers.isCurrent(track.index)"><span class="icon-play"></span></button>
            <button class="pause btn" ng-click="controlAudio.pause()" ng-show="helpers.isCurrent(track.index)"><span class="icon-pause"></span></button>
        </div>
        <div class="playlist-mark fl" ng-show="track.type === 'playlist' || track.type === 'playlist-repost'">
            <div class="btn"><span class="icon-playlist"></span><span class="plno">{{::track.tracks.length}}</span></div>
        </div>
        <div class="fl" ng-if="::track.index.length === 1">
            <img class="user-avatar" ng-src="{{::track.avatar}}" />
            <div ng-show="track.type === 'track-repost' || track.type === 'playlist-repost'" class="icon-repost icon repost"></div>
        </div>
        <span class="icon-new new" data-ng-if="::track.index.length === 1 && track.isNew"></span>
    </div>

    <!-- AUTHOR, DATE, TITLE, description and playlist tracks -->
    <div class="details">
        <div class="row head">
            <div class="main">
                <div class="row" ng-if="::track.index.length === 1">
                    <a class="user-name" ng-href="{{::track.userlink}}" target="_blank">{{::track.username}}</a>
                    <span class="date">{{::track.created}}</span>
                </div>
                <div class="row">
                    <a class="title" ng-href="{{::track.link}}" target="_blank">{{::track.title}}</a>
                </div>
                <div class="row toggledesc">
                    <button class="btn" ng-init="desc = false" ng-click="desc = !desc" ng-show="track.description" ng-class="{'shown': desc}"><span class="icon-more"></span></button>
                </div>
            </div>
            <div class="buttons">
                <span class="duration">{{::track.durationFormatted}}</span>
                <a class="buy btn" ng-if="track.buy" ng-href="{{::track.buy}}" target="_blank"><span class="icon-cart"></span></a>
                <a class="download btn" ng-if="track.downloadable" ng-href="{{helpers.download(track.scid)}}"><span class="icon-download"></span></a>
                <button class="like btn" ng-click="track.favoriteFlag ? like('delete', track.index) : like('put', track.index)" ng-class="{'favorite' : track.favoriteFlag}"><span class="icon-like"></span></button>
            </div>
        </div>
        <div class="row description" data-ng-show="desc">
            <div class="track-desc" ng-bind-html="track.description"></div>
            <img ng-if="track.artwork" ng-src="{{::track.artwork}}"/>
        </div>
        <div class="row playlist-tracks" data-ng-if="track.type === 'playlist' || track.type === 'playlist-repost'">
            <div
                ng-repeat="track in ::track.tracks"
                ng-include="'views/item.html'"
                class="item track row"
                ng-class="{active: helpers.isCurrent(track.index)}"></div>
        </div>
    </div>
</div>
<div class="track-progress" ng-style="{'width': (playerData.currentTime / playerData.duration) * 100 + '%'}" ng-if="helpers.isCurrent(track.index) && track.type !== 'playlist' && track.type !== 'playlist-repost'"></div>

<!-- SEPARATOR ITEM -->
<div class="separator" ng-if="(track.index[0] + 1)%50 === 0 && track.index[1] === undefined"><span class="icon-more icon"></span></div>
